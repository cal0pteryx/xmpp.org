<div class="alert alert-secondary" role="alert">
    <div class="d-flex flex-row">
        <div>
            <i class="fas fa-info-circle pe-2"></i>
        </div>
        <div>
            <span>
                The following table is sortable, just click on the headers (click twice to reverse the sort order).<br>
                You can show/hide the various types of XEPs by checking/unchecking the checkboxes below.
            </span>
        </div>
    </div>
</div>
<div class="xeplist">
    <div class="border-top border-start border-end p-3">
        <form action="#">
            <div id="status-selector">
                <div class="d-flex flex-wrap pb-2">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Proposed" name="Proposed" checked="checked" />
                        <label class="form-check-label" for="Proposed">Proposed</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Experimental" name="Experimental"
                            checked="checked" />
                        <label class="form-check-label" for="Experimental">Experimental</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Deferred" name="Deferred" checked="checked" />
                        <label class="form-check-label" for="Deferred">Deferred</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Stable" name="Stable" checked="checked" />
                        <label class="form-check-label" for="Stable">Stable</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Final" name="Final" checked="checked" />
                        <label class="form-check-label" for="Final">Final</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Active" name="Active" checked="checked" />
                        <label class="form-check-label" for="Active">Active</label>
                    </div>
                </div>
                <div class="d-flex flex-wrap">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Deprecated" name="Deprecated" />
                        <label class="form-check-label" for="Deprecated">Deprecated</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Obsolete" name="Obsolete" />
                        <label class="form-check-label" for="Obsolete">Obsolete</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Rejected" name="Rejected" />
                        <label class="form-check-label" for="Rejected">Rejected</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Retracted" name="Retracted" />
                        <label class="form-check-label" for="Retracted">Retracted</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="Dormant" name="Dormant" />
                        <label class="form-check-label" for="Dormant">Dormant</label>
                    </div>
                </div>
            </div>
        </form>
        <hr class="border">
        <div class="row justify-content-between align-items-center pb-2">
            <div class="col col-md-4">
                <input class="form-control form-control-sm" id="xep-search-input" type="text" placeholder="Search by title, number, etc. ..." aria-label="Search">
            </div>
            <div class="col col-md-4 text-end">
                <span id="xep-filter-results-count" class="text-muted small"></span>
            </div>
        </div>
    </div>
    <div class="table-responsive">
        <table class="sortable w-100" id="xeplist">
            <thead>
                <tr class="xepheader">
                    <th>Number</th>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Date</th>
                    <th>Tags</th>
                    <th>Implemen<br>tations</th>
                </tr>
            </thead>
            <tbody>
                {{- if .Site.Data.xeplist -}}
                    {{- range sort .Site.Data.xeplist ".number" -}}
                        {{- $number_str := printf "%04g" .number -}}
                        {{ $last_revision_date := .last_revision_date | time }}
                        {{ $last_revision_date_diff := now.Sub $last_revision_date }}
                        {{ $days_since_last_modification := math.Round (div $last_revision_date_diff.Hours 24) }}
                        {{ $xep_dormant := false }}
                        {{- if and (eq .type "Standards Track") (or (eq .status "Experimental") (eq .status "Deferred")) (gt ($days_since_last_modification) 365) (eq (len .implementations) 0) -}}
                            {{ $xep_dormant = true }}
                        {{- end -}}

                        <tr class="XEP-{{ .status }} {{ if $xep_dormant }} XEP-Dormant{{ end }}" id="xep{{- $number_str -}}" data-shortname="{{- .shortname -}}">
                            <td><a href="/extensions/xep-{{- $number_str -}}.html">XEP-{{- $number_str -}}</a></td>
                            <td>{{- .title -}}</td>
                            <td>{{- .type -}}</td>
                            <td>{{- .status -}}</td>
                            <td>{{- .last_revision_date -}}</td>
                            <td>
                                {{- range .tags -}}
                                    <span class="badge rounded-pill text-bg-secondary mx-1">{{- . -}}</span>
                                {{- end -}}
                            </td>
                            <td class="text-end pe-3 py-0">
                                <div class="d-flex align-items-center justify-content-end">
                                {{- if and (eq .type "Standards Track") (or (eq .status "Experimental") (eq .status "Deferred")) -}}
                                    {{- if and (gt ($days_since_last_modification) 365) (eq (len .implementations) 0) -}}
                                        <!-- This XEP has no recent activity and no implementations -> dormant -->
                                        <i class="fa-regular fa-moon text-muted me-2" data-bs-toggle="tooltip" title="Dormant: This XEP has been inactive for more than 12 months and there are no known implementations yet"></i>
                                    {{- end -}}
                                    {{- if and (gt ($days_since_last_modification) 365) (gt (len .implementations) 0) -}}
                                        <!-- This XEP has no recent activity, but implementations -> needs advancement -->
                                        <i class="fa-regular fa-clock text-muted me-2" data-bs-toggle="tooltip" title="Needs advancement: This XEP has been inactive for more than 12 months, but there are known implementations"></i>
                                    {{- end -}}
                                    {{- if and (lt ($days_since_last_modification) 365) (gt (len .implementations) 0) -}}
                                        <!-- This XEP has recent activity and implementations -> needs advancement and implementations -->
                                        <i class="fa-solid fa-rocket text-muted me-2" data-bs-toggle="tooltip" title="Needs advancements and implementations: This XEP has been actively developed in the past 12 months and there are known implementations"></i>
                                    {{- end -}}
                                    {{- if and (lt ($days_since_last_modification) 365) (eq (len .implementations) 0) -}}
                                        <!-- This XEP has recent activity, but no implementations -> needs implementations -->
                                        <i class="fa-solid fa-ruler-combined text-muted me-2" data-bs-toggle="tooltip" title="Needs implementations: This XEP has been actively developed in the past 12 months, but there are no known implementations yet"></i>
                                    {{- end -}}
                                {{- end -}}

                                {{- if or (eq .type "Standards Track") (eq .type "Historical") (eq .type "Informational") -}}
                                    <button type="button" class="btn btn-sm btn-outline-secondary" name="show-xep-implementations" data-xep="{{- $number_str -}}" role="button"
                                    {{- if eq (len .implementations) 0 -}}
                                    disabled
                                    {{- end -}}
                                    >
                                        {{- len .implementations -}}
                                    </button>
                                {{- end -}}
                                </div>
                            </td>
                        </tr>
                    {{- end -}}
                {{- end -}}
            </tbody>
        </table>
    </div>
</div>
<div class="offcanvas offcanvas-end" tabindex="-1" id="implementations-offcanvas" aria-labelledby="implementations-offcanvas-label">
    <div class="offcanvas-header">
        <h5 id="implementations-heading" class="offcanvas-title" id="implementations-offcanvas-label"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <table id="implementations-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th title="Implementation Status" data-bs-toggle="tooltip">Status</th>
                    <th title="Implemented Version" data-bs-toggle="tooltip">Version</th>
                </tr>
            </thead>
            <tbody id="implementations-table-body"></tbody>
        </table>
    </div>
  </div>
